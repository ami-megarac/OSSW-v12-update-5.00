/******************************************************************************
 *
 * INTEL CONFIDENTIAL
 *
 * Copyright 2021 Intel Corporation.
 *
 * This software and the related documents are Intel copyrighted materials, and
 * your use of them is governed by the express license under which they were
 * provided to you ("License"). Unless the License provides otherwise, you may
 * not use, modify, copy, publish, distribute, disclose or transmit this
 * software or the related documents without Intel's prior written permission.
 *
 * This software and the related documents are provided as is, with no express
 * or implied warranties, other than those that are expressly stated in
 * the License.
 *
 ******************************************************************************/

#pragma once
#include <array>
#include <map>
#include <utility>
#include <vector>

#include <tor_defs.hpp>

const std::array<const char*, 32> SPR_PORT_ID = {
    "KTI0",
    "KTI1",
    "KTI2",
    "KTI3",
    "IMC0",
    "IMC1",
    "IMC2",
    "IMC3",
    "IMC4",
    "IMC5",
    "IAL0",
    "IAL1",
    "IAL2",
    "IAL3",
    "IAL4",
    "IAL5",
    "IAL6",
    "IAL7",
    "not implemented",
    "PCIE0",
    "PCIE1",
    "PCIE2",
    "PCIE3",
    "PCIE4",
    "PCIE5",
    "PCIE6",
    "PCIE7",
    "PCIE8",
    "PCIE9",
    "PCIE10",
    "PCIE11",
    "UBOX",
};

const std::array<const char *, 16> SPR_LLCS = {
    "not implemented",
    "SF_S",
    "SF_E",
    "SF_H",
    "not implemented",
    "not implemented",
    "not implemented",
    "not implemented",
    "LLC_I",
    "LLC_S",
    "LLC_E",
    "LLC_M",
    "LLC_F",
    "LLC_D",
    "not implemented",
    "LLC_P",
};

const std::map<uint8_t, uint8_t> SprfirstErrorCha = {
    {0x80, 0}, {0x81, 1}, {0x82, 2}, {0x83, 3}, {0x84, 4},
    {0x85, 5}, {0x86, 6}, {0x87, 7}, {0x88, 8}, {0x89, 9},
    {0x8a, 10}, {0x8b, 11}, {0x8c, 12}, {0x8d, 13}, {0x8e, 14},
    {0x8f, 15}, {0x90, 16}, {0x91, 17}, {0x92, 18}, {0x93, 19},
    {0x94, 20}, {0x95, 21}, {0x96, 22}, {0x97, 23}, {0x98, 24},
    {0x99, 25}, {0x9a, 26}, {0x9b, 27}, {0x9c, 28}, {0x9d, 29},
    {0x9e, 30}, {0x9f, 31}, {0xa0, 32}, {0xa1, 33}, {0xa2, 34},
    {0xa3, 35}, {0xa4, 36}, {0xa5, 37}, {0xa6, 38}, {0xa7, 39},
    {0xa8, 40}, {0xa9, 41}, {0xaa, 42}, {0xab, 43}, {0xac, 44},
    {0xad, 45}, {0xae, 46}, {0xaf, 47}, {0xb0, 48}, {0xb1, 49},
    {0xb2, 50}, {0xb3, 51}, {0xb4, 52}, {0xb5, 53}, {0xb6, 54},
    {0xb7, 55}, {0xb8, 56}, {0xb9, 57}, {0xba, 58}, {0xbb, 59},
    {0xbc, 60}, {0xbd, 61}, {0xbe, 62}, {0xbf, 63}, {0xc0, 64},
    {0xc1, 65}, {0xc2, 66}, {0xc3, 67}, {0xc4, 68}, {0xc5, 69},
    {0xc6, 70}, {0xc7, 71},
};

const std::map<uint16_t, const char*> SprfirstError = {
    {0x80, "CHA0, bank 9"},
    {0x81, "CHA1, bank 10"},
    {0x82, "CHA2, bank 11"},
    {0x83, "CHA3, bank 9"},
    {0x84, "CHA4, bank 10"},
    {0x85, "CHA5, bank 11"},
    {0x86, "CHA6, bank 9"},
    {0x87, "CHA7, bank 10"},
    {0x88, "CHA8, bank 11"},
    {0x89, "CHA9, bank 9"},
    {0x8a, "CHA10, bank 10"},
    {0x8b, "CHA11, bank 11"},
    {0x8c, "CHA12, bank 9"},
    {0x8d, "CHA13, bank 10"},
    {0x8e, "CHA14, bank 11"},
    {0x8f, "CHA15, bank 9"},
    {0x90, "CHA16, bank 10"},
    {0x91, "CHA17, bank 11"},
    {0x92, "CHA18, bank 9"},
    {0x93, "CHA19, bank 10"},
    {0x94, "CHA20, bank 11"},
    {0x95, "CHA21, bank 9"},
    {0x96, "CHA22, bank 10"},
    {0x97, "CHA23, bank 11"},
    {0x98, "CHA24, bank 9"},
    {0x99, "CHA25, bank 10"},
    {0x9a, "CHA26, bank 11"},
    {0x9b, "CHA27, bank 9"},
    {0x9c, "CHA28, bank 10"},
    {0x9d, "CHA29, bank 11"},
    {0x9e, "CHA30, bank 9"},
    {0x9f, "CHA31, bank 10"},
    {0xa0, "CHA32, bank 11"},
    {0xa1, "CHA33, bank 9"},
    {0xa2, "CHA34, bank 10"},
    {0xa3, "CHA35, bank 11"},
    {0xa4, "CHA36, bank 9"},
    {0xa5, "CHA37, bank 10"},
    {0xa6, "CHA38, bank 11"},
    {0xa7, "CHA39, bank 9"},
    {0xa8, "CHA40, bank 10"},
    {0xa9, "CHA41, bank 11"},
    {0xaa, "CHA42, bank 9"},
    {0xab, "CHA43, bank 10"},
    {0xac, "CHA44, bank 11"},
    {0xad, "CHA45, bank 9"},
    {0xae, "CHA46, bank 10"},
    {0xaf, "CHA47, bank 11"},
    {0xb0, "CHA48, bank 9"},
    {0xb1, "CHA49, bank 10"},
    {0xb2, "CHA50, bank 11"},
    {0xb3, "CHA51, bank 9"},
    {0xb4, "CHA52, bank 10"},
    {0xb5, "CHA53, bank 11"},
    {0xb6, "CHA54, bank 9"},
    {0xb7, "CHA55, bank 10"},
    {0xb8, "CHA56, bank 11"},
    {0xb9, "CHA57, bank 9"},
    {0xba, "CHA58, bank 10"},
    {0xbb, "CHA59, bank 11"},
    {0xbc, "CHA60, bank 9"},
    {0xbd, "CHA61, bank 10"},
    {0xbe, "CHA62, bank 11"},
    {0xbf, "CHA63, bank 9"},
    {0xc0, "CHA64, bank 10"},
    {0xc1, "CHA65, bank 11"},
    {0xc2, "CHA66, bank 9"},
    {0xc3, "CHA67, bank 10"},
    {0xc4, "CHA68, bank 11"},
    {0xc5, "CHA69, bank 9"},
    {0xc6, "CHA70, bank 10"},
    {0xc7, "CHA71, bank 11"},
    {0x180, "PUNIT, bank 4"},
    {0x181, "PUNIT, bank 4"},
    {0x182, "PUNIT, bank 4"},
    {0x183, "PUNIT, bank 4"},
    {0x184, "PUNIT, bank 4"},
    {0x185, "PUNIT, bank 4"},
    {0x186, "OOBMSM, bank 6"},
    {0x1cc, "UBOX, bank 6"},
    {0x1cd, "UBOX, bank 6"},
    {0x1ce, "UBOX, bank 6"},
    {0x1da, "OOBMSM, bank 6"},
    {0x237, "PCIeg4_DMI_0, bank 6"},
    {0x238, "PCIeg4_0, bank 6"},
    {0x239, "PCIeg4_0, bank 6"},
    {0x23a, "PCIeg4_0, bank 6"},
    {0x23b, "PCIeg4_0, bank 6"},
    {0x23c, "PCIeg5_0, bank 6"},
    {0x23d, "PCIeg5_0, bank 6"},
    {0x23e, "PCIeg5_0, bank 6"},
    {0x23f, "PCIeg5_0, bank 6"},
    {0x24b, "PCIeg4_1, bank 6"},
    {0x24c, "PCIeg4_1, bank 6"},
    {0x24d, "PCIeg4_1, bank 6"},
    {0x24e, "PCIeg4_1, bank 6"},
    {0x24f, "PCIeg4_1, bank 6"},
    {0x250, "PCIeg5_1, bank 6"},
    {0x251, "PCIeg5_1, bank 6"},
    {0x252, "PCIeg5_1, bank 6"},
    {0x253, "PCIeg5_1, bank 6"},
    {0x25F, "PCIeg4_3, bank 6"},
    {0x260, "PCIeg4_3, bank 6"},
    {0x261, "PCIeg4_3, bank 6"},
    {0x262, "PCIeg4_3, bank 6"},
    {0x263, "PCIeg4_3, bank 6"},
    {0x264, "PCIeg5_3, bank 6"},
    {0x265, "PCIeg5_3, bank 6"},
    {0x266, "PCIeg5_3, bank 6"},
    {0x267, "PCIeg5_3, bank 6"},
    {0x273, "PCIeg4_5, bank 6"},
    {0x274, "PCIeg4_5, bank 6"},
    {0x275, "PCIeg4_5, bank 6"},
    {0x276, "PCIeg4_5, bank 6"},
    {0x277, "PCIeg4_5, bank 6"},
    {0x278, "PCIeg5_5, bank 6"},
    {0x279, "PCIeg5_5, bank 6"},
    {0x27A, "PCIeg5_5, bank 6"},
    {0x27B, "PCIeg5_5, bank 6"},
    {0x287, "PCIeg4_4, bank 6"},
    {0x288, "PCIeg4_4, bank 6"},
    {0x289, "PCIeg4_4, bank 6"},
    {0x28A, "PCIeg4_4, bank 6"},
    {0x28B, "PCIeg4_4, bank 6"},
    {0x28C, "PCIeg5_4, bank 6"},
    {0x28D, "PCIeg5_4, bank 6"},
    {0x28E, "PCIeg5_4, bank 6"},
    {0x28F, "PCIeg5_4, bank 6"},
    {0x29B, "PCIeg4_7, bank 6"},
    {0x29C, "PCIeg4_7, bank 6"},
    {0x29D, "PCIeg4_7, bank 6"},
    {0x29E, "PCIeg4_7, bank 6"},
    {0x29F, "PCIeg4_7, bank 6"},
    {0x2A0, "PCIeg5_7, bank 6"},
    {0x2A1, "PCIeg5_7, bank 6"},
    {0x2A2, "PCIeg5_7, bank 6"},
    {0x2A3, "PCIeg5_7, bank 6"},
    {0x2A6, "PCIeg4_2, bank 6"},
    {0x2A7, "PCIeg4_2, bank 6"},
    {0x2A8, "PCIeg4_2, bank 6"},
    {0x2A9, "PCIeg4_2, bank 6"},
    {0x2AA, "PCIeg4_2, bank 6"},
    {0x2AB, "PCIeg5_2, bank 6"},
    {0x2AC, "PCIeg5_2, bank 6"},
    {0x2E3, "PCIeg5_2, bank 6"},
    {0x2E4, "PCIeg5_2, bank 6"},
    {0x306, "PCIeg4_6, bank 6"},
    {0x307, "PCIeg4_6, bank 6"},
    {0x308, "PCIeg4_6, bank 6"},
    {0x309, "PCIeg4_6, bank 6"},
    {0x30A, "PCIeg4_6, bank 6"},
    {0x30B, "PCIeg5_6, bank 6"},
    {0x30C, "PCIeg5_6, bank 6"},
    {0x30D, "PCIeg5_6, bank 6"},
    {0x30E, "PCIeg5_6, bank 6"},
    {0x344, "UPI0, bank 5"},
    {0x345, "UPI0, bank 5"},
    {0x346, "UPI0, bank 5"},
    {0x347, "UPI0, bank 5"},
    {0x348, "UPI0, bank 5"},
    {0x34A, "UPI2, bank 8"},
    {0x34B, "UPI2, bank 8"},
    {0x34C, "UPI2, bank 8"},
    {0x34D, "UPI2, bank 8"},
    {0x34E, "UPI2, bank 8"},
    {0x350, "UPI1, bank 7"},
    {0x351, "UPI1, bank 7"},
    {0x352, "UPI1, bank 7"},
    {0x353, "UPI1, bank 7"},
    {0x354, "UPI1, bank 7"},
    {0x356, "UPI3"},
    {0x357, "UPI3"},
    {0x358, "UPI3"},
    {0x359, "UPI3"},
    {0x35A, "UPI3"},
    {0x3BE, "M2MEM0, bank 12"},
    {0x3BF, "M2MEM1, bank 16"},
    {0x3C0, "M2MEM2, bank 20"},
    {0x3C1, "M2MEM3, bank 24"},
    {0x3C6, "MCDDR0, bank 13, 14"},
    {0x3C7, "MCDDR1, bank 17, 18"},
    {0x3C8, "MCDDR2, bank 21, 22"},
    {0x3C9, "MCDDR3, bank 25, 26"},
};

const std::map<uint32_t, const char*> SprOpCodeDecode = {
    {0x101, "CRd"},
    {0x105, "CRd_UC"},
    {0x111, "CRd_Pref"},
    {0x102, "DRd"},
    {0x112, "DRd_Pref"},
    {0x104, "DRd_Opt"},
    {0x114, "DRd_Opt_Pref"},
    {0x106, "DRdPTE"},
    {0x113, "DRd_NS"},
    {0x103, "SetMonitor"},
    {0x100, "RFO"},
    {0x110, "RFO_Pref"},
    {0x107, "PRd"},
    {0x10e, "UCRdF"},
    {0x118, "CLFlush"},
    {0x11a, "CLFlush_Opt"},
    {0x11c, "CLWB"},
    {0x10f, "WiL"},
    {0x10d, "WCiL"},
    {0x10c, "WCiLF"},
    {0x115, "WCiL_NS"},
    {0x116, "WCiLF_NS"},
    {0x11f, "RFOWr"},
    {0x11e, "RdCurr"},
    {0x11d, "FsRdCur"},
    {0x13d, "FsRdCurPtl"},
    {0x109, "PCommit"},
    {0x13c, "CLCleanse"},
    {0x1c8, "Enqueue"},
    {0x149, "LLCWBInv"},
    {0x14b, "LLCWB"},
    {0x148, "LLCInv"},
    {0x188, "ItoM"},
    {0x1a8, "ItoMCacheNear"},
    {0x1a9, "RdCurrCacheNear"},
    {0x18a, "SpecItoM"},
    {0x189, "ItoMWr"},
    {0x18b, "ItoMWr_WT"},
    {0x181, "ItoMWr_NS"},
    {0x197, "ItoMWR_WT_NS"},
    {0x18d, "MemPushWr"},
    {0x19d, "MemPushWr_NS"},
    {0x199, "PrefCode"},
    {0x19a, "PrefData"},
    {0x198, "PrefRFO"},
    {0x184, "WbMtoI"},
    {0x185, "WbMtoE"},
    {0x186, "WbEFtoI"},
    {0x187, "WbEFtoE"},
    {0x194, "WbOtoI"},
    {0x195, "WbOtoE"},
    {0x18c, "WbStoI"},
    {0x1a4, "WbPushHint"},
    {0x1a5, "WbPMPushHint"},
    {0x180, "CLDemote"},
    {0x1dc, "PortIn"},
    {0x1d4, "IntA"},
    {0x1df, "Lock"},
    {0x1de, "SplitLock"},
    {0x1d3, "Unlock"},
    {0x1c0, "SpCyc"},
    {0x1d1, "ClrMonitor"},
    {0x1d5, "PortOut"},
    {0x1db, "IntPriUp"},
    {0x1d9, "IntLog"},
    {0x1da, "IntPhy"},
    {0x1d8, "EOI"},
    {0x1d0, "NOP"},
    {0x500, "RdCur"},
    {0x501, "RdCode"},
    {0x502, "RdData"},
    {0x503, "RdDataMig"},
    {0x504, "RdInvOwn"},
    {0x505, "InvXtoI"},
    {0x506, "PushHint"},
    {0x507, "InvItoE"},
    {0x508, "RSVD8"},
    {0x509, "RSVD9"},
    {0x50a, "RSVD10"},
    {0x50b, "RSVD11"},
    {0x50c, "RdInv"},
    {0x50d, "RSVD13"},
    {0x50e, "RSVD14"},
    {0x50f, "InvItoM"},
    {0x400, "WbMtoI"},
    {0x401, "WbMtoS"},
    {0x402, "WbMtoE"},
    {0x403, "NonSnpWr"},
    {0x404, "WbMtoIPtl"},
    {0x405, "RSVD5"},
    {0x406, "WbMtoEPtl"},
    {0x407, "NonSnpWrPtl"},
    {0x408, "WbPushMtoI"},
    {0x409, "RSVD9"},
    {0x40a, "RSVD10"},
    {0x40b, "WbFlush"},
    {0x40c, "EvctCln"},
    {0x40d, "NonSnpRd"},
    {0x40e, "RSVD14"},
    {0x700, "SnpCur"},
    {0x701, "SnpCode"},
    {0x702, "SnpData"},
    {0x703, "SnpDataMig"},
    {0x704, "SnpInvOwn"},
    {0x705, "SnpInv"},
    {0x706, "RSVD6"},
    {0x707, "RSVD7"},
    {0x708, "SnpFCur"},
    {0x709, "SnpFCode"},
    {0x70a, "SnpFData"},
    {0x70b, "SnpFDataMig"},
    {0x70c, "SnpFInvOwn"},
    {0x70d, "SnpFInv"},
    {0x70e, "RSVD14"},
    {0x0, "RSPI"},
    {0x1, "RSPS"},
    {0x2, "RSPDATAM"},
    {0x3, "RSPIFWDM"},
    {0x4, "PULLDATA"},
    {0x5, "PULLDATABOGUS"},
    {0x6, "CMP"},
    {0x7, "CMP_FWDCODE"},
    {0x8, "CMP_FWDINVITOE"},
    {0x9, "CMP_PULLDATA"},
    {0xb, "CMP_FWDINVOWN"},
    {0xc, "DATAC_CMP"},
    {0xd, "DATAC_CMP_RSPI"},
    {0x10, "FAKECYCLE"},
    {0x13, "GNTE_CMP"},
    {0x14, "GNTE_CMP_RSPI"},
    {0x17, "GNTE_CMP_PULLDATA"},
    {0x18, "GNTE_CMP_RSPI_PULLDATA"},
    {0x1b, "VICTIM"},
    {0x1d, "GSRISINMSTATE"},
    {0x1e, "DATANC"},
    {0x20, "DATAC"},
    {0x23, "RSPIFWDFE"},
    {0x24, "RSPSFWDFE"},
    {0x26, "RSPV"},
    {0x27, "RSPVFWDV"},
    {0x30, "TOR_TIMEOUT"},
    {0x25, "FWDCNFLT"},
    {0x32, "RSPNACK"},
    {0x31, "LLCVICTIM"},
    {0x33, "RSPIFWDMPTL"},
    {0x34, "PULLDATAPTL"},
    {0x35, "MKTMEVICTIM"},
};