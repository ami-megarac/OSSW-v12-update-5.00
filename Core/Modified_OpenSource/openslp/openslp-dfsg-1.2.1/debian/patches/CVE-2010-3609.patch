Description: fix denial of service via circular reference
Origin: vendor, https://build.opensuse.org/package/view_file?file=openslp.parseext.diff&package=openslp&project=openSUSE%3A11.4&srcmd5=38039c725b8a6c1e0cdd4efdffa8bcc8

Index: openslp-dfsg-1.2.1/common/slp_message.c
===================================================================
--- openslp-dfsg-1.2.1.orig/common/slp_message.c	2011-04-05 14:29:12.063825536 -0400
+++ openslp-dfsg-1.2.1/common/slp_message.c	2011-04-05 14:29:25.203825532 -0400
@@ -872,10 +872,19 @@
     int             extid;
     int             nextoffset;
     int             result  = SLP_ERROR_OK;
+    int             bufsz = (int)(buffer->end - buffer->start);
 
     nextoffset = message->header.extoffset;
     while(nextoffset)
     {
+        /* check for circular reference in list
+         * if the size gets below zero, we know we're
+         * reprocessing extensions in a loop.
+         */
+        bufsz -= 5;
+        if (bufsz <= 0) 
+            return SLP_ERROR_PARSE_ERROR;
+
         buffer->curpos = buffer->start + nextoffset;
         if(buffer->curpos + 5 >= buffer->end)
         {
