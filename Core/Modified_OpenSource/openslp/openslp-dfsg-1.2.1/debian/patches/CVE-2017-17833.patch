Description: Lenovo fix for slpd crash during testing: bad pointer after realloc.
Author: John Calcote
Author: Utkarsh Gupta <guptautkarsh2102@gmail.com>
Origin: https://sourceforge.net/p/openslp/mercurial/ci/151f07745901cbdba6e00e4889561b4083250da1/
Last-Update: 2019-12-07

--- a/slpd/slpd_process.c
+++ b/slpd/slpd_process.c
@@ -377,6 +377,15 @@
                          SLP_DA_SERVICE_TYPE) == 0)
     {
         errorcode = ProcessDASrvRqst(message, sendbuf, errorcode);
+
+        if (result != *sendbuf)
+        {
+           // The pointer stored at *sendbuf can be modified by a realloc
+           // operation in ProcessDASrvRqst().  Fix up the local copy of
+           // that pointer if necessary.
+           result = *sendbuf;
+        }
+
         if (errorcode == 0)
         {
             // Since we have an errorcode of 0, we were successful,
