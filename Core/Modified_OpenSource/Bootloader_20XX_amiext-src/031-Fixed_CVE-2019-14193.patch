--- uboot_patch029/net/net.c	2020-09-07 10:13:48.318098335 +0800
+++ uboot/net/net.c	2020-09-07 11:05:43.243153584 +0800
@@ -1282,6 +1282,9 @@
 			return;
 		}
 
+		if (ntohs(ip->udp_len) < UDP_HDR_SIZE || ntohs(ip->udp_len) > ntohs(ip->ip_len))
+			return;
+
 		debug_cond(DEBUG_DEV_PKT,
 			   "received UDP (to=%pI4, from=%pI4, len=%d)\n",
 			   &dst_ip, &src_ip, len);
